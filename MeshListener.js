const dgram = require('dgram'); const fs = require('fs'); const port = 4569; const server = dgram.createSocket('udp4'); const memory = []; server.on('message', (msg, rinfo) => { try { const data = JSON.parse(msg.toString()); memory.push({ ts: new Date().toISOString(), ...data }); console.log('[MeshListener] 📥', data); } catch (e) { console.log('[MeshListener] ⚠️ Invalid packet:', msg.toString()); } }); server.bind(port, () => console.log('[MeshListener] ✅ Listening on UDP 4569 for mesh packets')); process.on('SIGINT', () => { fs.writeFileSync('mesh.memory.json', JSON.stringify(memory,null,2)); console.log('\n[MeshListener] 💾 Saved mesh.memory.json'); process.exit(); });
